const canvas=document.getElementById("gameCanvas"),ctx=canvas?canvas.getContext("2d"):null;let GAME_WIDTH=canvas?canvas.width:480,GAME_HEIGHT=canvas?canvas.height:800,score=0,gameActive=!1,gameSpeed=2,bamboos=[],bugs=[],panda=null,lastBugSpawn=0,bugSpawnInterval=1500,bambooOffset=0,invulnerableTimer=0;const INVULNERABLE_DURATION=2e3,GAME_BOTTOM_SPACE=200;let canvasOffsetY=0;const MAX_BUGS=2;let bugSpawnChance=.5;const ASSETS={panda:"https://png.pngtree.com/png-clipart/20240427/ourmid/pngtree-chibi-cute-panda-png-image_12323796.png",bug:"https://upload.wikimedia.org/wikipedia/commons/3/3f/Crystal_Project_bug.png",background:"https://24hstore.vn/upload_images/images/hinh-nen-gau-truc/hinh-avatar-gau-truc-cute.jpg",cake:"https://www.creativefabrica.com/wp-content/uploads/2021/12/03/Cake-PNG-File-Cute-Clip-Art-Graphics-21158823-1-1-580x387.png",person:"./image/tk.png",cake2:"https://png.pngtree.com/png-clipart/20241206/original/pngtree-birthday-cake-clipart-png-image_17627567.png"};let loadedAssets={},assetsToLoad=Object.keys(ASSETS).length,assetsLoaded=0;const SCREENS={LOADING:document.getElementById("loading-screen"),START:document.getElementById("start-screen"),GAME:document.getElementById("game-screen"),GAME_OVER:document.getElementById("game-over-screen")};let gameWon=!1,winAnimationTimer=0;const WIN_SCORE=5,CAKES_NEEDED=1;let cakesCollected=0;const WIN_ANIMATION_DURATION=5e3,PANDA_MESSAGES=["ui, tui gi·ªèi gh√™! üêº","ch∆∞a ƒë·ªß wow! üí™","tui l√† ƒëom ƒë√≥m ƒë√¢y? üòé","b·ªç h·ªïng b·∫Øt ƒë∆∞·ª£c ƒë√¢u! üòù","qu√° nhanh qu√° nguy hi·ªÉm! üöÄ","n√© b·ªç nh∆∞ n√© trai IT! üòÇ","ch·∫°y nhanh nh∆∞ h·∫°n deadline! ‚è∞","tui l√† ninja panda! ü•∑","panda kh√¥ng s·ª£ b·ªç! üêû","s·∫Øp wow r·ªìi ƒë√≥! üåü","panda ch√®m matcha latteee! üçµ","panda ch√®m qingwacha! üçµ","Jack l·∫•p l√°nh tr√™n b·∫ßu tr·ªùi r·ªông l·ªõn! üåå","nh∆∞ m·ªçi v√¨ tinh t√∫...J"];let lastMessageMilestone=0,cake=null,cakeY=-100,personX=GAME_WIDTH/2,personY=GAME_HEIGHT+100,endingPhase=0,bambooStopTimer=0;class Bamboo{constructor(e){this.x=e,this.width=50,this.color="#5D8B3E",this.segmentHeight=100,this.segmentOffset=0}update(){this.segmentOffset=(this.segmentOffset+gameSpeed)%this.segmentHeight}draw(){ctx.fillStyle=this.color,ctx.fillRect(this.x-this.width/2,0,this.width,GAME_HEIGHT);for(let e=-this.segmentOffset;e<GAME_HEIGHT;e+=this.segmentHeight)ctx.fillStyle="#3D5A28",ctx.fillRect(this.x-this.width/2-5,e,this.width+10,12)}}class Bug{constructor(e){this.bambooIndex=e,this.x=bamboos[e].x,this.y=GAME_HEIGHT+50,this.width=60,this.height=60,this.speed=1.2*gameSpeed}update(){return this.y-=this.speed,this.y<-50}draw(){ctx.drawImage(loadedAssets.bug,this.x-this.width/2,this.y-this.height/2,this.width,this.height)}checkCollision(e,t,a,n){return!(invulnerableTimer>0)&&(this.bambooIndex===panda.currentBamboo&&Math.abs(this.y-t)<.7*(this.height/2+n/2))}}class Panda{constructor(){this.currentBamboo=1,this.x=bamboos[this.currentBamboo].x,this.y=GAME_HEIGHT/2,this.width=140,this.height=140,this.moving=!1,this.targetX=this.x,this.moveSpeed=12,this.falling=!1,this.rotation=0,this.fallSpeed=0,this.gravity=.5,this.jumping=!1,this.jumpY=0,this.jumpHeight=0,this.jumpSpeed=10,this.holdingCake=!1}moveLeft(){this.currentBamboo>0&&!this.moving&&(this.currentBamboo--,this.targetX=bamboos[this.currentBamboo].x,this.moving=!0)}moveRight(){this.currentBamboo<bamboos.length-1&&!this.moving&&(this.currentBamboo++,this.targetX=bamboos[this.currentBamboo].x,this.moving=!0)}update(){if(this.moving){const e=this.targetX-this.x;Math.abs(e)>this.moveSpeed?this.x+=Math.sign(e)*this.moveSpeed:(this.x=this.targetX,this.moving=!1)}return!!this.falling&&(this.fallSpeed+=this.gravity,this.y+=this.fallSpeed,this.rotation+=.05,this.y>GAME_HEIGHT+100)}startFalling(){this.falling=!0,this.fallSpeed=2}startSlideDown(){this.falling=!0,this.fallSpeed=0,this.rotation=Math.PI/6}startJumping(){this.jumping=!0,this.jumpY=this.y,this.jumpHeight=0;const e=document.getElementById("jump-sound");e&&e.play().catch((e=>console.log("Sound error:",e)))}updateJump(){if(this.jumping){if(this.jumpHeight<200)this.jumpHeight+=this.jumpSpeed,this.y=this.jumpY-this.jumpHeight,this.rotation=-Math.PI/10;else if(this.y+=1.5*this.jumpSpeed,this.rotation=Math.PI/6,this.y>GAME_HEIGHT+150)return 1===endingPhase&&(endingPhase=2),!0;return!1}return!1}draw(){ctx.save(),this.falling||this.jumping?(ctx.translate(this.x,this.y),ctx.rotate(this.rotation),ctx.drawImage(loadedAssets.panda,-this.width/2,-this.height/2,this.width,this.height)):ctx.drawImage(loadedAssets.panda,this.x-this.width/2,this.y-this.height/2,this.width,this.height),ctx.restore()}}class Cake{constructor(e){this.bambooIndex=e,this.x=bamboos[e].x,this.y=GAME_HEIGHT+50,this.width=580/3,this.height=129,this.collected=!1,this.image=loadedAssets.cake,this.speed=gameSpeed}update(){return this.y-=this.speed,this.y<-50}draw(){this.image&&!this.collected&&ctx.drawImage(this.image,this.x-this.width/2,this.y-this.height/2,this.width,this.height)}checkCollision(e,t,a,n){return this.bambooIndex===panda.currentBamboo&&Math.abs(this.y-t)<.7*(this.height/2+n/2)}}function loadAssets(){for(const[e,t]of Object.entries(ASSETS)){const a=new Image;a.onload=()=>{assetsLoaded++,assetsLoaded===assetsToLoad&&setTimeout((()=>{showScreen(SCREENS.START)}),3e3)},a.onerror=()=>{console.error(`Failed to load asset: ${e}`),assetsLoaded++,assetsLoaded===assetsToLoad&&setTimeout((()=>{showScreen(SCREENS.START)}),3e3)},a.src=t,loadedAssets[e]=a}setTimeout((()=>{SCREENS.START.classList.contains("hidden")&&showScreen(SCREENS.START)}),7e3)}function showScreen(e){for(const e in SCREENS)SCREENS[e]&&SCREENS[e].classList.add("hidden");e&&e.classList.remove("hidden")}let gameLoopId=null;function getRandomMessage(){if(!window.shuffledMessages||0===window.shuffledMessages.length){window.shuffledMessages=[...PANDA_MESSAGES];for(let e=window.shuffledMessages.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[window.shuffledMessages[e],window.shuffledMessages[t]]=[window.shuffledMessages[t],window.shuffledMessages[e]]}}return window.shuffledMessages.pop()}function showPandaMessage(e){e||(e=getRandomMessage()),clearPandaMessage();let t=document.createElement("div");t.className="speech-bubble",t.id="panda-speech-bubble",document.querySelector(".game-container").appendChild(t),t.textContent=e,t.style.fontWeight="bold",t.style.animation="bubble-appear 0.5s forwards, bubble-float 2s ease-in-out infinite alternate";const a=()=>{if(!t.parentNode||!gameActive)return;const e=document.querySelector(".game-container").getBoundingClientRect(),n=canvas.getBoundingClientRect(),s=panda.x/GAME_WIDTH*n.width,o=panda.y/GAME_HEIGHT*n.height;t.style.left=s+n.left-e.left+"px",t.style.bottom=n.height-o+80+"px",t.style.transform="translateX(-50%)",t.parentNode&&(window.speechBubbleAnimId=requestAnimationFrame(a))};a(),window.pandaMessageTimeout=setTimeout((()=>{clearPandaMessage()}),3e3)}function clearPandaMessage(){window.speechBubbleAnimId&&(cancelAnimationFrame(window.speechBubbleAnimId),window.speechBubbleAnimId=null),window.pandaMessageTimeout&&(clearTimeout(window.pandaMessageTimeout),window.pandaMessageTimeout=null);const e=document.getElementById("panda-speech-bubble");e&&(e.style.animation="bubble-disappear 0.5s forwards",setTimeout((()=>{e.parentNode&&e.parentNode.removeChild(e)}),500))}function updateScoreDisplay(){const e=document.getElementById("score"),t=document.querySelector(".score-container");e&&t&&(e.textContent=score,Math.floor(score/3)>Math.floor(lastMessageMilestone/3)&&(showPandaMessage(),lastMessageMilestone=score),t.classList.add("score-pulse"),setTimeout((()=>{t.classList.remove("score-pulse")}),300),t.classList.remove("bg-success","score-milestone-10","score-milestone-15","score-milestone-18"),score>=18?t.classList.add("score-milestone-18"):score>=15?t.classList.add("score-milestone-15"):score>=10?t.classList.add("score-milestone-10"):t.classList.add("bg-success"))}function initGame(){score=0,gameWon=!1,winAnimationTimer=0,lastMessageMilestone=0,cakesCollected=0,cake=null,bambooStopTimer=0,updateScoreDisplay(),gameSpeed=2,bugSpawnInterval=1500,bambooOffset=0,invulnerableTimer=2e3,document.querySelector("#game-over-screen h2").textContent="Thua g√≤i nhaaaa!!!",document.querySelector("#game-over-screen h2").className="display-5 fw-bold text-danger mb-3",document.querySelector("#game-over-screen p").innerHTML='N√© ƒë∆∞·ª£c <span id="final-score" class="text-warning fw-bold">0</span> con b·ªç lu√¥n!',gameLoopId&&cancelAnimationFrame(gameLoopId),bamboos=[];for(let e=0;e<3;e++){const t=GAME_WIDTH*(e+.5)/3;bamboos.push(new Bamboo(t))}panda=new Panda,panda.holdingCake=!1,bugs=[],lastBugSpawn=Date.now()+1e3,endingPhase=0,gameActive=!0,gameLoopId=requestAnimationFrame(gameLoop)}function createCake(){let e=[];for(let t=0;t<bamboos.length;t++)t!==panda.currentBamboo&&e.push(t);0===e.length&&e.push((panda.currentBamboo+1)%bamboos.length);const t=e[Math.floor(Math.random()*e.length)];cake=new Cake(t),showPandaMessage("b√°nh kem ai ƒë·ªÉ ƒë√¢y z·∫≠y ta? üéÇ")}function collectCake(){cake&&panda&&(cake.collected=!0,panda&&(panda.holdingCake=!0),cakesCollected++,showPandaMessage("l·∫•y ƒë∆∞·ª£c b√°nh r√≤i, xu·ªëng thoiii üéÇ"),bambooStopTimer=4e3,cakesCollected>=CAKES_NEEDED&&setTimeout((()=>{gameWon=!0,winAnimationTimer=0,bugs=[]}),5e3),cake=null)}function gameLoop(){if(gameActive){if(invulnerableTimer>0&&(invulnerableTimer-=16),ctx.clearRect(0,0,GAME_WIDTH,GAME_HEIGHT),drawBackground(),gameWon){if(bamboos.forEach((e=>e.draw())),winAnimationTimer+=16,0===endingPhase)canvasOffsetY<GAME_BOTTOM_SPACE?canvasOffsetY+=4:winAnimationTimer>1e3&&(panda.startSlideDown(),endingPhase=1);else if(1===endingPhase){const e=panda.update();panda.draw(),e&&(endingPhase=2)}else if(2===endingPhase){const e=document.getElementById("score"),t=document.querySelector(".score-container");t&&t.classList.remove("bg-success","score-milestone-10","score-milestone-15","score-milestone-18"),e&&(e.style.display="none");const a=document.getElementById("bg-bd");return a&&(a.currentTime=0,a.play().catch((e=>console.log("Sound error:",e)))),void function(){if(ctx.clearRect(0,0,GAME_WIDTH,GAME_HEIGHT),ctx.fillStyle="#d9f2d9",ctx.fillRect(0,0,GAME_WIDTH,GAME_HEIGHT),loadedAssets.person){const e=142.8,t=266.4;ctx.drawImage(loadedAssets.person,GAME_WIDTH/2-150,GAME_HEIGHT/2-t/2+50,e,t)}const e=GAME_WIDTH/2+70,t=GAME_HEIGHT/2+50;ctx.drawImage(loadedAssets.panda,e-75,t-75,150,150),ctx.drawImage(loadedAssets.cake2,GAME_WIDTH/2-50,t-20,100,80),ctx.textAlign="center",ctx.fillStyle="white",ctx.shadowColor="rgba(0,0,0,0.5)",ctx.shadowBlur=5,ctx.font="bold 36px Arial",ctx.fillText("Happy Birthday!",GAME_WIDTH/2,100),panda.x=GAME_WIDTH/2+70,panda.y=GAME_HEIGHT/2+50;const a=[];setInterval((function(){const e=[];for(let t=0;t<100;t++){const t=Math.random()*Math.PI*2,a=3*Math.random()+2;e.push({x:GAME_WIDTH/2,y:GAME_HEIGHT/3,dx:Math.cos(t)*a,dy:Math.sin(t)*a,alpha:1})}a.push(e)}),1e3),function e(){ctx.clearRect(0,0,GAME_WIDTH,GAME_HEIGHT),ctx.fillStyle="#d9f2d9",ctx.fillRect(0,0,GAME_WIDTH,GAME_HEIGHT);const t=GAME_HEIGHT/2+50;ctx.save(),ctx.shadowColor="rgb(255, 255, 255)",ctx.shadowBlur=20,ctx.drawImage(loadedAssets.person,.2*GAME_WIDTH-71.4,t-133.2,142.8,266.4),ctx.restore(),ctx.drawImage(loadedAssets.cake2,GAME_WIDTH/2-50,t-40,100,80),ctx.save(),ctx.shadowColor="rgba(135, 206, 250, 0.7)",ctx.shadowBlur=20,ctx.drawImage(loadedAssets.panda,.8*GAME_WIDTH-75,t-75,150,150),ctx.restore(),ctx.textAlign="center",ctx.fillStyle=`hsl(${360*Math.random()}, 100%, 50%)`,ctx.shadowColor="rgba(0,0,0,0.5)",ctx.shadowBlur=5,ctx.font="bold 36px Arial",ctx.fillText("Happy Birthday!",GAME_WIDTH/2,100),ctx.font="bold 25px Arial",ctx.fillText("19 tu·ªïi r·ªìi ƒë√≥ nha!",GAME_WIDTH/2,150);for(let e=a.length-1;e>=0;e--){const t=a[e];for(let e of t)e.x+=e.dx,e.y+=e.dy,e.dy+=.05,e.alpha-=.015,ctx.fillStyle=`rgba(${Math.floor(255*Math.random())}, ${Math.floor(255*Math.random())}, ${Math.floor(255*Math.random())}, ${e.alpha})`,ctx.beginPath(),ctx.arc(e.x,e.y,3,0,2*Math.PI),ctx.fill();a[e]=t.filter((e=>e.alpha>0)),0===a[e].length&&a.splice(e,1)}requestAnimationFrame(e)}(),function(){const e=["H√¥m nay l√† sinh nh·∫≠t ch·ªã Tr√∫c Ki·ªÅu üéâ",1e3,"Panda s·∫Ω h√°t m·ªôt b√†i choa ch·ªã nghe nha! üé§",3e3,"B·∫Øt ƒë·∫ßu n√®! üé∂",5e3],t=["Happy birthday to you! üéµ",3e3,"Happy birthday to you! üé∂",6e3,"Happy birthday, happy birthday! üéÇ",11e3,"Happy birthday to you! üéâ",15e3,"panda h√°t hay hongggg?",19e3,"ch√∫c empe sinh nh·∫≠t vui v·∫ª nha!",21e3,"empe lu√¥n xinh ƒë·∫πp v√† h·∫°nh ph√∫c!",23e3,"empe c·ªßa anh l√† nh·∫•t lu√¥n!",25e3,"th·∫±ng vƒÉn di·ªán n√≥ n√≥i z·ªã ƒë√≥ ch·ªã!",27e3,"hehehehehehe!",29e3,"h·∫øt √≤iiii, ch∆°i gem t√≠p iiii!",31e3];setTimeout((()=>{showPandaMessage(e[0])}),e[1]),setTimeout((()=>{showPandaMessage(e[2])}),e[3]),setTimeout((()=>{showPandaMessage(e[4])}),e[5]),setTimeout((()=>{for(let e=0;e<t.length;e+=2){const a=t[e],n=t[e+1];setTimeout((()=>{"string"==typeof a&&showPandaMessage(a)}),n)}}),6e3),function(){const e=Math.floor(winAnimationTimer/500)%3;ctx.fillStyle="#333";for(let t=0;t<5;t++){const a=(winAnimationTimer/1e3+t)%(2*Math.PI),n=GAME_WIDTH/2+100+50*Math.cos(a),s=GAME_HEIGHT/2-30+25*Math.sin(a)-5*e;ctx.beginPath(),ctx.arc(n,s,6,0,2*Math.PI),ctx.fill(),ctx.fillRect(n+6,s,2,-20)}}()}()}()}}else{if(bambooStopTimer<=0?bamboos.forEach((e=>{e.update(),e.draw()})):(bambooStopTimer-=16,bamboos.forEach((e=>{e.draw()})),bambooStopTimer<=0&&panda.holdingCake&&(gameWon=!0,winAnimationTimer=0)),cakesCollected<CAKES_NEEDED&&!panda.holdingCake){const e=Date.now();if(e-lastBugSpawn>bugSpawnInterval){const t=[];for(let e=0;e<bamboos.length;e++){if(invulnerableTimer>0&&e===panda.currentBamboo)continue;let a=!1;for(const t of bugs)if(t.bambooIndex===e&&t.y>.7*GAME_HEIGHT){a=!0;break}a||t.push(e)}t.sort((()=>Math.random()-.5));const a=bugs.length,n=Math.min(MAX_BUGS-a,t.length);for(let e=0;e<n;e++)Math.random()<bugSpawnChance&&bugs.push(new Bug(t[e]));lastBugSpawn=e,bugSpawnInterval>800&&(bugSpawnInterval-=10),gameSpeed<8&&(gameSpeed+=.03),bugSpawnChance<.8&&(bugSpawnChance+=.005)}for(let e=bugs.length-1;e>=0;e--){const t=bugs[e].update();if(bugs[e].checkCollision(panda.x,panda.y,panda.width,panda.height))return void gameOver();bugs[e].y<panda.y-panda.height/2&&!bugs[e].scored&&(score+=1,bugs[e].scored=!0,updateScoreDisplay(),score%5==0&&score>0&&!cake&&!panda.holdingCake&&createCake(),cake&&cake.update()&&(cake=null)),t&&bugs.splice(e,1)}}cake&&!cake.collected&&(cake.update(),cake.checkCollision(panda.x,panda.y,panda.width,panda.height)&&collectCake())}bugs.forEach((e=>e.draw())),cake&&!cake.collected&&cake.draw(),(!gameWon||gameWon&&endingPhase<2)&&(panda.jumping||panda.falling||panda.update(),invulnerableTimer>0&&Math.floor(invulnerableTimer/200)%2==0?(ctx.globalAlpha=.7,panda.draw(),ctx.globalAlpha=1):panda.draw()),drawFrame(),gameLoopId=requestAnimationFrame(gameLoop)}}function drawBackground(){if(loadedAssets.background){const e=loadedAssets.background.width/loadedAssets.background.height;let t,a,n,s;e>GAME_WIDTH/GAME_HEIGHT?(a=GAME_HEIGHT,t=a*e,n=(GAME_WIDTH-t)/2,s=0):(t=GAME_WIDTH,a=t/e,n=0,s=(GAME_HEIGHT-a)/2),ctx.globalAlpha=.6,ctx.drawImage(loadedAssets.background,n,s,t,a),ctx.globalAlpha=1}else{const e=ctx.createLinearGradient(0,0,0,GAME_HEIGHT);e.addColorStop(0,"#e8f5e8"),e.addColorStop(1,"#d9f2d9"),ctx.fillStyle=e,ctx.fillRect(0,0,GAME_WIDTH,GAME_HEIGHT)}ctx.globalAlpha=.1;for(let e=0;e<5;e++)drawBambooLeaf(Math.random()*GAME_WIDTH,Math.random()*GAME_HEIGHT,30+20*Math.random(),"#3D5A28");ctx.globalAlpha=1}function drawFrame(){}function drawBambooLeaf(e,t,a,n){ctx.save(),ctx.translate(e,t),ctx.rotate(Math.random()*Math.PI*2),ctx.fillStyle=n,ctx.beginPath(),ctx.ellipse(0,0,a/3,a,0,0,2*Math.PI),ctx.fill(),ctx.restore()}function showBirthdayMessage(){let e=document.querySelector(".speech-bubble");e||(e=document.createElement("div"),e.className="speech-bubble birthday-message",document.querySelector(".game-container").appendChild(e)),e.innerHTML="üéµ Happy Birthday to You! üéÇ",e.style.fontSize="18px",e.style.animation="bubble-appear 0.5s forwards, bubble-float 2s ease-in-out infinite alternate";const t=document.querySelector(".game-container").getBoundingClientRect(),a=canvas.getBoundingClientRect(),n=(GAME_WIDTH/2+60)/GAME_WIDTH*a.width,s=(GAME_HEIGHT-100)/GAME_HEIGHT*a.height;e.style.left=n+a.left-t.left+"px",e.style.top=s+a.top-t.top-80+"px",e.style.transform="translateX(-50%)"}function gameOver(){gameActive=!1,gameLoopId&&(cancelAnimationFrame(gameLoopId),gameLoopId=null);const e=document.getElementById("fall-sound");e&&e.play().catch((e=>console.log("Sound error:",e))),setTimeout((()=>{panda.startFalling()}),300);const t=document.querySelector(".speech-bubble.birthday-message");t&&t.parentNode&&t.parentNode.removeChild(t),requestAnimationFrame(gameOverAnimation)}function gameOverAnimation(){ctx.clearRect(0,0,GAME_WIDTH,GAME_HEIGHT),drawBackground(),bamboos.forEach((e=>e.draw())),bugs.forEach((e=>e.draw()));const e=panda.update();if(panda.draw(),e){const e=document.getElementById("final-score");e&&(e.textContent=score),showScreen(SCREENS.GAME_OVER),gameSpeed=2,bugSpawnInterval=1500}else requestAnimationFrame(gameOverAnimation)}function handleResize(){const e=document.querySelector(".game-container"),t=window.innerWidth,a=window.innerHeight;if(e)if(t<768)e.style.width="100%",e.style.height="100vh",canvas&&(GAME_WIDTH=t,GAME_HEIGHT=a,canvas.width=GAME_WIDTH,canvas.height=GAME_HEIGHT);else{const n=Math.min(t,9*a/16),s=16*n/9;e.style.width=`${n}px`,e.style.height=`${s}px`}if(gameActive&&panda&&bamboos.length>0){const e=bamboos.length;for(let t=0;t<e;t++)bamboos[t].x=GAME_WIDTH*(t+.5)/e;panda.x=bamboos[panda.currentBamboo].x,panda.targetX=panda.x}}window.addEventListener("load",(()=>{handleResize(),window.addEventListener("resize",handleResize),canvas&&(canvas.style.width="100%",canvas.style.height="100%"),loadAssets(),document.getElementById("start-button").addEventListener("click",(()=>{const e=document.getElementById("click");e&&e.play().catch((e=>console.log("Sound error:",e))),gameLoopId&&(cancelAnimationFrame(gameLoopId),gameLoopId=null),gameSpeed=2,bugSpawnInterval=1500,showScreen(SCREENS.GAME),initGame()})),document.getElementById("restart-button").addEventListener("click",(()=>{const e=document.getElementById("click");e&&e.play().catch((e=>console.log("Sound error:",e))),gameLoopId&&(cancelAnimationFrame(gameLoopId),gameLoopId=null),gameSpeed=2,bugSpawnInterval=1500,showScreen(SCREENS.GAME),initGame()})),document.getElementById("home-button").addEventListener("click",(()=>{const e=document.getElementById("click");e&&e.play().catch((e=>console.log("Sound error:",e))),gameLoopId&&(cancelAnimationFrame(gameLoopId),gameLoopId=null),showScreen(SCREENS.START)}))})),document.addEventListener("keydown",(e=>{gameActive&&("ArrowLeft"===e.key||"a"===e.key?panda.moveLeft():"ArrowRight"!==e.key&&"d"!==e.key||panda.moveRight())})),document.addEventListener("touchstart",(e=>{if(!gameActive)return;e.touches[0].clientX<window.innerWidth/2?panda.moveLeft():panda.moveRight()}));
